Kirchhoff矩阵树定理（简称矩阵树定理）解决了一张图的生成树个数计数问题。

## 本篇记号声明

**本篇中的图，无论无向还是有向，都允许重边，但是不允许自环。**

### 无向图情况

设$G$是一个有$n$个顶点的无向图。定义度数矩阵$D(G)$为：
$$D_{ii}(G) = \mathrm{deg}(i), D_{ij} = 0, i\neq j$$ 
设$\#e(i,j)$为点$i$与点$j$相连的边数，并定义邻接矩阵$A$为：
$$A_{ij}(G)=\#e(i,j), i\neq j$$ 
定义Laplace矩阵（亦称Kirchhoff矩阵）$L$为：
$$L(G) = D(G) - A(G)$$
记图$G$的所有生成树个数为$t(G)$。

### 有向图情况

设$G$是一个有$n$个顶点的有向图。定义出度矩阵$D^{out}(G)$为：
$$D^{out}_{ii}(G) = \mathrm{deg^{out}}(i), D^{out}_{ij} = 0, i\neq j$$ 
类似地定理入度矩阵$D^{in}(G)$
设$\#e(i,j)$为点$i$指向点$j$的有向边数，并定义邻接矩阵$A$为：
$$A_{ij}(G)=\#e(i,j), i\neq j$$ 
定义出度Laplace矩阵$L^{out}$为：
$$L^{out}(G) = D^{out}(G) - A(G)$$
类似地定义入度Laplace矩阵$L^{in}$。
记图$G$的以$r$为根的所有根向树形图个数为$t^{root}(G,r)$。所谓根向树形图，是说这张图的基图是一棵树，所有的边全部指向父亲。
记图$G$的以$r$为根的所有叶向树形图个数为$t^{leaf}(G,r)$。所谓叶向树形图，是说这张图的基图是一棵树，所有的边全部指向儿子。

## 定理叙述

矩阵树定理具有多种形式。其中用得较多的是定理1、定理3与定理4。

**定理1(矩阵树定理，无向图行列式形式)** 对于任意的$i$，都有
$$t(G) = \det L(G)\binom{1,2,...,i-1,i+1,...,n}{1,2,...,i-1,i+1,...,n}$$
其中记号$L(G)\binom{1,2,...,i-1,i+1,...,n}{1,2,...,i-1,i+1,...,n}$表示矩阵$L(G)$的第$1,...,i-1,i+1,...,n$行与第$1,...,i-1,i+1,...,n$列构成的子矩阵。也就是说，无向图的Laplace矩阵具有这样的性质，它的所有$n-1$阶主子式都相等。

**定理2(矩阵树定理，无向图特征值形式)** 设$\lambda_1, \lambda_2, ..., \lambda_{n-1}$为$L(G)$的$n - 1$个非零特征值，那么有
$$t(G) = \frac{1}{n}\lambda_1\lambda_2...\lambda_{n-1}$$

**定理3(矩阵树定理，有向图根向形式)** 对于任意的$k$，都有
$$t^{root}(G,k) = \det L^{out}(G)\binom{1,2,...,k-1,k+1,...,n}{1,2,...,k-1,k+1,...,n}$$
因此如果要统计一张图所有的根向树形图，只要枚举所有的根$k$并对$t^{root}(G,k)$求和即可。

**定理4(矩阵树定理，有向图叶向形式)** 对于任意的$k$，都有
$$t^{leaf}(G,k) = \det L^{in}(G)\binom{1,2,...,k-1,k+1,...,n}{1,2,...,k-1,k+1,...,n}$$
因此如果要统计一张图所有的叶向树形图，只要枚举所有的根$k$并对$t^{leaf}(G,k)$求和即可。

## 定理的应用

（挖坑）

## 注释

根向树形图在一些地方被称为内向树形图，但因为计算内向树形图用的是出度，为了不引起in和out的混淆，所以采用了根向这一说法。